> [!theorem] Caratheodory Extension Theorem
> Let $\mu_0$ be a [[pre-measure]] over the [[measurable space#^algebra|algebra]] $\AAA_0$. Then there exists a unique [[measure space|measure]] $\mu: \AAA\to [0,\infty)$ on the generated $\sigma$-[[measurable space|algebra]] $\AAA$ such that $\mu_0(A) = \mu(A)$ for all $A\in \AAA_0$.

This theorem is completely legendary; its what makes measure theory tick. In topology, if I hand you $\RR^2$ and ask you to draw an open set, you draw some connected blob and _have confidence that your intuition is completely general_. In measure theory, this lets you do the same thing.

# Uniqueness

The uniqueness portion of the proof uses [[pi lambda system|Dynkin's Theorem]]. Suppose there were two distinct extensions $\mu_1$ and $\mu_2$ of $\mu_0$. They all agree on $A\in \AAA_0$, so we can let

$$
    \LL = \{B \in \AAA : \mu_1(B) = \mu_2(B)\}
$$

Observe that $\AAA\subset \LL$, and we know $\AAA$ is a $\pi$-system because it is an algebra.

> [!claim]
>
> $\LL$ is a $\lambda$-system.

By Dynkin's theorem, we conclude that $\AAA\subset \LL \subset \AAA$, thus $\mu_1 = \mu_2$ on all of $\AAA$.

> [!proof]- Direct verification of claim
> $\Omega \in \LL$ because $\Omega\in \mathcal{A}$ and $\mu_1(\Omega) = \mu_2(\Omega)$. If $A\subset B$ are in $\LL$, then $\mu_1(B\setminus A) = \mu_1(B) - \mu_1(A) = \mu_2(B) - \mu_2(A) = \mu_2(B\setminus A)$, so $B\setminus A$ is in $\LL$. Finally, if $A_1, A_2, \dots$ are in $\LL$ and $A_i \uparrow A$, then by countable additivity,
>
> $$
>   \mu_1(A) = \lim \mu_1(A_i) = \lim \mu_2(A_i) = \mu_2(A)
> $$
>
> so $A$ is in $\LL$.

# Existence

The construction of the Caratheodory extension requires lots of machinery. First, we'll upgrade $\mu_0$ to _all_ subsets of $\Omega$ (this _overshoots_ what we're trying to do!) before restricting it to our desired $\sigma$-algebra.

## Outer Measure

> [!definition] Outer Measure
> The ==**outer measure**== $\mu^*$ over $\Omega$ is a function $\mu^*: 2^\Omega \to [0,\infty]$ such that:
>
> -   $\mu^*(\emptyset) = 0$.
> -   ==**Monotonicity**==: if $A \subseteq B$, then $\mu^*(A) \leq \mu^*(B)$.
> -   ==**Countable Subadditivity**==: if $A_1, A_2, \dots \subseteq \Omega$, then
>     $$
>       \mu^*\left(\bigcup A_i\right) \leq \sum \mu^*(A_i).
>     $$

> [!example] Outer Measures are easy to create
> Here's a slightly stupid way to construct an outer measure. Let $\rho: \mathcal{E} \to [0,\infty]$ be any function, where $\mathcal{E}\subset 2^\Omega$. Then,
>
> $$
>   \mu^*(A) = \inf\left(\sum_{i=1}^\infty \rho(K_i) : K_i\in \mathcal{E},  A \subseteq \bigcup_{i = 1}^\infty K_i\right)
> $$
>
> is an outer measure. This is called the ==**outer measure generated by $\rho$**==.

> [!proof]-
> $\mu^*(\emptyset) = 0$ is clear. Monotonicity is clear; if $A\subseteq B$, any collection $\{K_i\}$ that works for $B$ works for $A$.
> Countable subadditivity is a good exercise in $\NN$-strength logic. First off, if any of the $\mu^*(A_i)$ are $\infty$, then the inequality is trivial. On the other hand, countable absolutely convergent sums commute with infimums, so
>
> $$
> \sum \mu^* (A_i) = \inf\left(\sum_{i=1}^\infty \sum_{j = 1}^\infty \rho(K_{i,j}) : A_i \subseteq \bigcup_{j = 1}^\infty K_{i,j}\right).
> $$
>
> Alright fine, but clearly $K_{i,j}$ taken altogether is a countable collection of sets that covers $\bigcup A_i$. So we're done.

For general $\rho$, this $\mu^*$ is probably meaningless; in particular, it probably isn't compatible with $\rho$ at all. But for $\rho = \mu_0$, $\mu^*$ is the correct upgrade.

> [!theorem] Outer Measures generated by Pre-Measures
> The outer measure $\mu^*$ generated by a pre-measure $\mu_0$ satisfies $\mu^*(A) = \mu_0(A)$ for all $A \in \AAA_0$.

> [!proof]-
> Obviously $\mu_0(A)\geq \mu^*(A)$; let $K_0 = A$. To show $\mu_0(A)\leq \mu^*(A)$, lets fix any collection of sets $A_1,\cdots$ which cover $A$. We want to show
>
> $$
>   \mu_0(A) \leq \sum \mu_0(A_i).
> $$
>
> This looks almost exactly like the definition of $\mu_0$; we just need to get rid of the overlaps. Fine; let
>
> $$
> B_i = A\cap\left(A_1\cup \cdots A_i\right),\qquad C_i = B_i \setminus B_{i-1}.
> $$
>
> Then, its clear that each $C_i\in \AAA_0$ and form a disjoint partition of $A$. For all finite $n$,
>
> $$
> \sum_{i = 1}^n \mu_0(A_i) \geq \sum_{i = 1}^n \mu_0(C_i)
> $$
>
> This inequality holds in the limit, where the RHS is $\mu_0(A)$ by countable additivity.

In the case of the [[Lebesgue Measure]], at this step we let $\lambda^*$ be the outer measure generated by $\lambda_0$. Thus, we are now guaranteed that intervals have the correct length. Here's another observation:

> [!example] Outer Measures are Infimums of Open Sets
> For every subset $A\subset \RR$ and $\eps > 0$, there exists an open set $U$ such that $A\subset U$ and $\lambda^*(U)\leq \lambda^*(A)\leq  \lambda^*(U) + \eps$. Indeed, if $\lambda^*(A) = \infty$, $U = \RR$ works. Otherwise, let $\{I_i\}$ be a countable collection of open intervals that cover $A$ with length at most $\lambda^*(A) + \eps$. Then, $U = \bigcup I_i$ works by countable subadditivity.

## Caratheodory Measureability

> [!definition] Caratheodory Measurable
> A set $A$ is ==**Caratheodory measurable**== with respect to outer measure $\mu^*$ if for all $E \subseteq \Omega$,
>
> $$
>   \mu^*(E) = \mu^*(E\cap A) + \mu^*(E\setminus A).
> $$
>
> The $\sigma$-algebra of Caratheodory measurable sets is denoted $\AAA^{\text{cm}}$.

Of course, implicit in this definition is a bunch of detail-checking to show that $\AAA^{\text{cm}}$ is a $\sigma$-algebra.

> [!idea] Tips on verification
>
> -   By subadditivity, we already know $\mu^*(E) \leq \mu^*(E\cap A) + \mu^*(E\setminus A)$. $A$ is measurable iff $\mu^*(E) \geq \mu^*(E\cap A) + \mu^*(E\cap A^c)$.
> -   If $\mu^*(E) = \infty$, then the inequality is trivial.
> -   We can actually inductively iterate this. Let $E\subset \Omega$, and let $A_1,\cdots A_n$ be disjoint measurable sets. Then,
>     $$
>       \mu^*(E\cap (A_1\cup \cdots \cup A_n)) = \sum_{i = 1}^n \mu^*(E\cap A_i).
>     $$
> -   In particular, $\mu^*$ is obviously finitely additive on $\AAA^{\text{cm}}$.

> [!proof]- Caratheodory is an Algebra
> $\AAA^{\text{cm}}$ is clearly closed under complements, and contains $\emptyset$. Suppose $A$ and $B$ are Caratheodory measurable. Then, for any $E$, by subadditivity
>
> $$
> \mu^*(E\cap (A\cup B)) \leq \mu^*(E\cap A) + \mu^*(E\cap B\setminus A)
> $$
>
> Now, $A$ is measurable, so $\mu^*(E\cap A) = \mu^*(E) - \mu^*(E\setminus A)$. $B$ is measurable, so $m^*(E\setminus A) = m^*(E\setminus (A\cup \setminus B)) + m^*((E\setminus A)\cap B)$. Combining,
>
> $$
> \mu^*(E\cap (A\cup B)) \leq \mu^*(E) - \mu^*(E\setminus (A\cup \setminus B))
> $$
>
> Thus $A\cup B$ is measurable; thus finite unions are measurable.

> [!proof]- Caratheodory is a $\sigma$-Algebra
> Alright, game time. Give me a bunch of random measurable sets $A_1,A_2,\cdots$; I want to show their union, $A = \bigcup A_i$, is measurable. First, I'm going to make them disjoint. Let
>
> $$
>   B_n = A_n \setminus \bigcup_{i = 1}^{n-1} A_i.
> $$
>
> Clearly the $B_n$ are disjoint measurable sets, and $\bigcup A_i = \bigcup B_i$. Next, pick any stupid set $E$. In order to show the Caratheodory property, I'm going to truncate our sum at $N$; let
>
> $$
>   C_N = \bigcup_{i = 1}^N B_i
> $$
>
> We know that $C_N$ is measurable, so
>
> $$
> \mu^*(E) = \mu^*(E \cap C_N) + \mu^*(E\setminus C_N)
> $$
>
> By countable additivity on $E \cap C_N$ and monotonicity on $E\setminus C_N$, we find
>
> $$
>   \mu^*(E) \geq \sum_{n\leq N} \mu^*(E\cap B_n) + \mu^*(E\setminus A)
> $$
>
> Fine. This is true for all $N$ though, so we can take the limit:
>
> $$
> \mu^*(E) \geq \sum_{n\geq 1} \mu^*(E\cap B_n) + \mu^*(E\setminus A)\geq \mu^*(E\cap A) + \mu^*(E\setminus A)
> $$
>
> by countable subadditivity.

Over $\RR$, these are the ==**Lebesgue measurable**== sets, $\LL(\RR)$.

> [!theorem] Caratheodory compatible with Pre-Measure
> We should make sure that if $\mu^*$ is generated by a pre-measure $\mu_0$, then all $A\in \AAA_0$ are Caratheodory measurable.

> [!proof]-
> For all $\eps > 0$, there exists a covering $E\subset \bigcup K_i$ using sets $K_i \in \AAA_0$ such that
>
> $$
> \mu^*(E) + \eps \geq \sum \mu_0(K_i) = \sum \mu_0(K_i \cap A) + \sum \mu_0(K_i \setminus A)\geq \mu^*(E\cap A) + \mu^*(E\setminus A).
> $$

Thus, we find that the Borel $\sigma$-algebra $\BBB(\RR)$ is contained in $\LL(\RR)$. In any case, to create a measure space on $\Omega$, simply restrict _any_ outer measure $\mu^*$ to the Caratheodory measurable sets.

> [!theorem] This is actually a Measure
> The restriction of $\mu^*$ to $\AAA^{\text{cm}}$ is countably additive.

> [!proof]
> Suppose $A_1, A_2,\cdots$ are disjoint measurable sets. Then for all $n$,
>
> $$
>   \mu^*\left( \bigcup A_i \right) \geq \sum_{i = 1}^n \mu^*(A_i)
> $$
>
> by finite additivity. Taking the limit, we conclude.

## Restriction

Thus, we have constructed a measure $\mu^*$ on $\AAA^{\text{cm}}$; in particular, $\AAA_0 \subset \AAA^{\text{cm}}$, thus $\sigma(\AAA_0) = \AAA\subset \AAA^{\text{cm}}$. We thus can speak unambiguously of the measure $\mu: \AAA \to [0,\infty]$ obtained by restricting $\mu^*$ to $\AAA$.

# Properties

1. All measure spaces constructed in this way are [[complete measure space#^caratheodory-complete|complete]].

> [!problem] Littlewood's First Principle
> Suppose $E\subset \RR$ with $\lambda^*(E) < \infty$. Show that $E$ is measurable iff for all $\eps > 0$, there exists a _finite_ union of intervals $I_1, \cdots, I_N$ such that
>
> $$
> \lambda^*\left( E\Delta \bigcup I_i \right) < \eps.
> $$
>
> where $\Delta$ means symmetric difference.

> [!solution]-
> Suppose $E$ is measurable, and fix $\eps$. By definition of the outer measure, there exists a countable cover of intervals $I_i$ with measure arbitrarily close to $\mu^*(E)$:
>
> $$
>   \sum \mu(I_i) < \mu^*(E) + 0.001\eps.
> $$
>
> By countable subadditivity and monotonicity, we also know
>
> $$
> \mu^*(E) < \mu\left(\bigcup I_i\right) < \mu^*(E) + 0.001\eps
> $$
>
> We know countable unions of open sets are generated by $\AAA_0$ and thus in $\AAA^{cm}$;
>
> $$
>   \mu^*\left( \bigcup I_i \setminus E\right) = \mu^*\left( \bigcup I_i \right) - \mu^*(E) < 0.001\eps.
> $$
>
> Finally, the sum on the LHS is strictly increasing thus this inequality is true for any prefix $N$. Thus, we can take $N$ large enough such that
>
> $$
>   \mu^*\left( E \setminus \bigcup_{i=1}^N I_i \right) < \mu^*\left( \bigcup_{i\geq N} I_i\right) < 0.001\eps.
> $$
>
> This concludes.
> On the other hand, suppose you give me a $A\subset \RR$ and $\eps > 0$. I'll pick a finite union of intervals called $U\in \AAA_0$ such that $\mu^*(A\Delta U) < 0.001\eps$. Then for all $E$,
>
> $$
>   \mu^*(A\setminus E) \leq \mu^*(A\cap (E^c \cap U^c)) + \mu^*(A\cap (E^c \cap U)) \leq 0.001\eps + \mu^*(U\setminus E)
> $$
>
> and
>
> $$
>   \mu^*(A\cap E) \leq \mu^*(A\cap (E\cap U^c)) + \mu^*(A\cap (E\cap U)) \leq 0.001\eps + \mu^*(U\cap E)
> $$
>
> Adding it all up,
>
> $$
>   \mu^*(A\setminus E) + \mu^*(A\cap E) \leq 0.002\eps + \mu^*(U) \leq 0.003\eps + \mu^*(A)
> $$
>
> by countable subadditivity.